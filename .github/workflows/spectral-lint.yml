name: Spectral Lint Commited OpenAPI Spec

# Trigger the workflow on pull requests and pushes to the main branch
on:
  pull_request:
  push:
    branches:
      - main
  workflow_call:
    inputs:
      spectral_version:
        description: 'Version of Spectral to use'     
        type: string
        required: true

jobs:
  spectral-lint:
    runs-on: ubuntu-latest
    
    steps:
      # Checkout the code
      - name: Checkout repository
        uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332

      - name: Run 
        id: spectral-validation
        env:
          SPECTRAL_VERSION: ${{ inputs.spectral_version }}
        run: npx -- @stoplight/spectral-cli@"${SPECTRAL_VERSION}" lint openapi/v2.yaml --ruleset=tools/spectral/.spectral.yaml # we will update this to lint the FOAS in CLOUDP-263186


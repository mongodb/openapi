components:
    parameters:
        collectionName:
            description: Human-readable label that identifies the collection.
            in: path
            name: collectionName
            required: true
            schema:
                example: mycoll
                type: string
        databaseName:
            description: Human-readable label that identifies the database.
            in: path
            name: databaseName
            required: true
            schema:
                example: mydb
                type: string
        end:
            description: Date and time when MongoDB Cloud stops reporting the metrics. This parameter expresses its value in the ISO 8601 timestamp format in UTC. Include this parameter when you do not set **period**.
            in: query
            name: end
            schema:
                format: date-time
                type: string
        envelope:
            description: Flag that indicates whether Application wraps the response in an `envelope` JSON object. Some API clients cannot access the HTTP response headers or status code. To remediate this, set envelope=true in the query. Endpoints that return a list of results use the results object as an envelope. Application adds the status parameter to the response body.
            in: query
            name: envelope
            schema:
                default: false
                type: boolean
        federationSettingsId:
            description: Unique 24-hexadecimal digit string that identifies your federation.
            in: path
            name: federationSettingsId
            required: true
            schema:
                example: 55fa922fb343282757d9554e
                pattern: ^([a-f0-9]{24})$
                type: string
        granularity:
            description: Duration that specifies the interval at which Atlas reports the metrics. This parameter expresses its value in the ISO 8601 duration format in UTC.
            in: query
            name: granularity
            required: true
            schema:
                example: PT1M
                type: string
        groupId:
            description: |-
                Unique 24-hexadecimal digit string that identifies your project. Use the [/groups](#tag/Projects/operation/listProjects) endpoint to retrieve all projects to which the authenticated user has access.

                **NOTE**: Groups and projects are synonymous terms. Your group id is the same as your project id. For existing groups, your group/project id remains the same. The resource and corresponding endpoints use the term groups.
            in: path
            name: groupId
            required: true
            schema:
                example: 32b6e34b3d91647abb20e7b8
                pattern: ^([a-f0-9]{24})$
                type: string
            x-xgen-IPA-exception:
                xgen-IPA-117-description-should-not-use-inline-links: Parameters don't support externalDocs.
        identityProviderId:
            description: Legacy 20-hexadecimal digit string that identifies the identity provider. This id can be found within the Federation Management Console > Identity Providers tab by clicking the info icon in the IdP ID row of a configured identity provider.
            in: path
            name: identityProviderId
            required: true
            schema:
                example: c2777a9eca931f29fc2f
                pattern: ^([a-f0-9]{20})$
                type: string
        includeCount:
            description: Flag that indicates whether the response returns the total number of items (**totalCount**) in the response.
            in: query
            name: includeCount
            schema:
                default: true
                type: boolean
        indexName:
            description: Human-readable label that identifies the index.
            in: path
            name: indexName
            required: true
            schema:
                example: myindex
                type: string
        itemsPerPage:
            description: Number of items that the response returns per page.
            in: query
            name: itemsPerPage
            schema:
                default: 100
                maximum: 500
                minimum: 1
                type: integer
        liveMigrationId:
            description: Unique 24-hexadecimal digit string that identifies the migration.
            in: path
            name: liveMigrationId
            required: true
            schema:
                example: 6296fb4c7c7aa997cf94e9a8
                pattern: ^([a-f0-9]{24})$
                type: string
        orgId:
            description: Unique 24-hexadecimal digit string that identifies the organization that contains your projects. Use the [/orgs](#tag/Organizations/operation/listOrganizations) endpoint to retrieve all organizations to which the authenticated user has access.
            in: path
            name: orgId
            required: true
            schema:
                example: 4888442a3354817a7320eb61
                pattern: ^([a-f0-9]{24})$
                type: string
            x-xgen-IPA-exception:
                xgen-IPA-117-description-should-not-use-inline-links: Parameters don't support externalDocs.
        pageNum:
            description: Number of the page that displays the current set of the total objects that the response returns.
            in: query
            name: pageNum
            schema:
                default: 1
                minimum: 1
                type: integer
        period:
            description: Duration over which Atlas reports the metrics. This parameter expresses its value in the ISO 8601 duration format in UTC. Include this parameter when you do not set **start** and **end**.
            in: query
            name: period
            schema:
                example: PT10H
                type: string
        pretty:
            description: Flag that indicates whether the response body should be in the prettyprint format.
            in: query
            name: pretty
            schema:
                default: false
                externalDocs:
                    description: Prettyprint
                    url: https://en.wikipedia.org/wiki/Prettyprint
                type: boolean
        processId:
            description: Combination of hostname and IANA port that serves the MongoDB process. The host must be the hostname, fully qualified domain name (FQDN), or Internet Protocol address (IPv4 or IPv6) of the host that runs the MongoDB process (mongod or mongos). The port must be the IANA port on which the MongoDB process listens for requests.
            in: path
            name: processId
            required: true
            schema:
                example: my.host.name.com:27017
                pattern: ^([0-9]{1,3}\.){3}[0-9]{1,3}|([0-9a-f]{1,4}\:){7}([0-9a-f]{1,4})|(([a-z0-9]+\.){1,10}[a-z]+)?(\:[0-9]{4,5})$
                type: string
        sandboxConfigId:
            description: Unique 24-hexadecimal digit string that identifies the sandbox configuration.
            in: path
            name: sandboxConfigId
            required: true
            schema:
                example: 507f1f77bcf86cd799439011
                pattern: ^([a-f0-9]{24})$
                type: string
        start:
            description: Date and time when MongoDB Cloud begins reporting the metrics. This parameter expresses its value in the ISO 8601 timestamp format in UTC. Include this parameter when you do not set **period**.
            in: query
            name: start
            schema:
                format: date-time
                type: string
    responses:
        accepted:
            description: Accepted.
        badRequest:
            content:
                application/json:
                    example:
                        detail: (This is just an example, the exception may not be related to this endpoint) No provider AWS exists.
                        error: 400
                        errorCode: VALIDATION_ERROR
                        reason: Bad Request
                    schema:
                        $ref: '#/components/schemas/ApiError'
            description: Bad Request.
        conflict:
            content:
                application/json:
                    example:
                        detail: '(This is just an example, the exception may not be related to this endpoint) Cannot delete organization link while there is active migration in following project ids: 60c4fd418ebe251047c50554'
                        error: 409
                        errorCode: CANNOT_DELETE_ORG_ACTIVE_LIVE_MIGRATION_ATLAS_ORG_LINK
                        reason: Conflict
                    schema:
                        $ref: '#/components/schemas/ApiError'
            description: Conflict.
        forbidden:
            content:
                application/json:
                    example:
                        detail: (This is just an example, the exception may not be related to this endpoint)
                        error: 403
                        errorCode: CANNOT_CHANGE_GROUP_NAME
                        reason: Forbidden
                    schema:
                        $ref: '#/components/schemas/ApiError'
            description: Forbidden.
        gone:
            content:
                application/json:
                    example:
                        detail: This happens when a resource is marked for sunset and the sunset date is in the past.
                        error: 410
                        errorCode: VERSION_GONE
                        reason: Gone
                    schema:
                        $ref: '#/components/schemas/ApiError'
            description: Gone.
        internalServerError:
            content:
                application/json:
                    example:
                        detail: (This is just an example, the exception may not be related to this endpoint)
                        error: 500
                        errorCode: UNEXPECTED_ERROR
                        reason: Internal Server Error
                    schema:
                        $ref: '#/components/schemas/ApiError'
            description: Internal Server Error.
        methodNotAllowed:
            content:
                application/json:
                    example:
                        detail: (This is just an example, the exception may not be related to this endpoint)
                        error: 405
                        errorCode: ATLAS_BACKUP_CANCEL_SHARD_RESTORE_JOB_NOT_ALLOWED
                        reason: Method Not Allowed
                    schema:
                        $ref: '#/components/schemas/ApiError'
            description: Method Not Allowed.
        noBody:
            description: This endpoint does not return a response body.
        notFound:
            content:
                application/json:
                    example:
                        detail: (This is just an example, the exception may not be related to this endpoint) Cannot find resource AWS
                        error: 404
                        errorCode: RESOURCE_NOT_FOUND
                        reason: Not Found
                    schema:
                        $ref: '#/components/schemas/ApiError'
            description: Not Found.
        paymentRequired:
            content:
                application/json:
                    example:
                        detail: (This is just an example, the exception may not be related to this endpoint)
                        error: 402
                        errorCode: NO_PAYMENT_INFORMATION_FOUND
                        reason: Payment Required
                    schema:
                        $ref: '#/components/schemas/ApiError'
            description: Payment Required.
        tooManyRequests:
            content:
                application/json:
                    example:
                        detail: (This is just an example, the exception may not be related to this endpoint)
                        error: 429
                        errorCode: RATE_LIMITED
                        reason: Too Many Requests
                    schema:
                        $ref: '#/components/schemas/ApiError'
            description: Too Many Requests.
        unauthorized:
            content:
                application/json:
                    example:
                        detail: (This is just an example, the exception may not be related to this endpoint)
                        error: 401
                        errorCode: NOT_ORG_GROUP_CREATOR
                        reason: Unauthorized
                    schema:
                        $ref: '#/components/schemas/ApiError'
            description: Unauthorized.
    schemas:
        ApiError:
            properties:
                badRequestDetail:
                    $ref: '#/components/schemas/BadRequestDetail'
                detail:
                    description: Describes the specific conditions or reasons that cause each type of error.
                    type: string
                error:
                    description: HTTP status code returned with this error.
                    externalDocs:
                        url: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status
                    format: int32
                    readOnly: true
                    type: integer
                errorCode:
                    description: Application error code returned with this error.
                    readOnly: true
                    type: string
                parameters:
                    description: Parameters used to give more information about the error.
                    items:
                        readOnly: true
                        type: object
                    readOnly: true
                    type: array
                reason:
                    description: Application error message returned with this error.
                    readOnly: true
                    type: string
            required:
                - error
                - errorCode
            type: object
        AssociatedInvoice:
            description: An invoice associated with an organization.
            properties:
                invoiceId:
                    description: Unique 24-hexadecimal digit identifier for an invoice.
                    type: string
                orgId:
                    description: Unique 24-hexadecimal digit identifier for an organization.
                    type: string
            type: object
        BadRequestDetail:
            description: Bad request detail.
            properties:
                fields:
                    description: Describes all violations in a client request.
                    items:
                        $ref: '#/components/schemas/FieldViolation'
                    type: array
            readOnly: true
            type: object
        FieldViolation:
            properties:
                description:
                    description: A description of why the request element is bad.
                    type: string
                field:
                    description: A path that leads to a field in the request body.
                    type: string
            required:
                - description
                - field
            type: object
        OrgAssociatedInvoiceResponse:
            description: Response containing associated invoices for an organization.
            properties:
                associatedInvoices:
                    description: List of invoices associated with the organization for the specified period.
                    items:
                        $ref: '#/components/schemas/AssociatedInvoice'
                    type: array
                month:
                    description: Two-digit number that represents the month of the associated invoices.
                    example: "01"
                    type: string
                year:
                    description: Four-digit number that represents the year of the associated invoices.
                    example: "2024"
                    type: string
            type: object
        ReportGenerationRequest:
            properties:
                reportFormat:
                    description: Format of the report.
                    enum:
                        - CSV
                    type: string
                reportType:
                    description: Type of report to generate.
                    enum:
                        - FOCUS
                    type: string
                version:
                    description: Version of the report format specification.
                    type: string
            type: object
    securitySchemes:
        DigestAuth:
            scheme: digest
            type: http
        ServiceAccounts:
            description: Learn more about [Service Accounts](https://www.mongodb.com/docs/atlas/api/service-accounts-overview).
            flows:
                clientCredentials:
                    scopes: {}
                    tokenUrl: https://cloud.mongodb.com/api/oauth/token
            type: oauth2
info:
    description: |-
        The MongoDB Atlas Administration API allows developers to manage all components in MongoDB Atlas.

        The Atlas Administration API uses OAuth2 Service Accounts or HTTP Digest Authentication to authenticate requests. Provide a programmatic API public key and corresponding private key as the username and password when constructing the HTTP request. For example, to [return database access history](#tag/Access-Tracking/operation/listAccessLogsByClusterName) with [cURL](https://en.wikipedia.org/wiki/CURL), run the following command in the terminal:

        ```
        curl --user "{PUBLIC-KEY}:{PRIVATE-KEY}" \
          --digest \
          --header "Accept: application/vnd.atlas.private-preview-invoicereporting+json" \
          -X GET "https://cloud.mongodb.com/api/atlas/v2/groups/{groupId}/dbAccessHistory/clusters/{clusterName}?pretty=true"
        ```

        To learn more, see [Get Started with the Atlas Administration API](https://www.mongodb.com/docs/atlas/configure-api-access/). For support, see [MongoDB Support](https://www.mongodb.com/support/get-started).

        You can also explore the various endpoints available through the Atlas Administration API in MongoDB's [Postman workspace](https://www.postman.com/mongodb-devrel/workspace/mongodb-atlas-administration-apis/).
    license:
        name: CC BY-NC-SA 3.0 US
        url: https://creativecommons.org/licenses/by-nc-sa/3.0/us/
    termsOfService: https://www.mongodb.com/mongodb-management-service-terms-and-conditions
    title: MongoDB Atlas Administration API
    version: "2.0"
    x-xgen-sha: bf0bd642be34d0b9405b8b64672d1ccbc2286df9
openapi: 3.0.1
paths:
    /api/atlas/v2/orgs/{orgId}/associatedInvoices:
        get:
            description: |-
                This API is in preview. Breaking changes might be introduced before it is released. Don't use preview APIs in production.

                 Returns a list of invoice IDs for the specified organization and month/year. Optionally includes invoices from linked organizations.
            operationId: getOrgAssociatedInvoices
            parameters:
                - $ref: '#/components/parameters/orgId'
                - description: The month for which to retrieve invoices (1-12). Defaults to current month.
                  in: query
                  name: month
                  schema:
                    format: int64
                    maximum: 12
                    minimum: 1
                    type: integer
                - description: The year for which to retrieve invoices. Defaults to current year.
                  in: query
                  name: year
                  schema:
                    format: int64
                    minimum: 2000
                    type: integer
                - description: Whether to include invoices from linked organizations. Defaults to false.
                  in: query
                  name: includeLinkedOrgs
                  schema:
                    type: boolean
            responses:
                "200":
                    content:
                        application/vnd.atlas.preview+json:
                            schema:
                                $ref: '#/components/schemas/OrgAssociatedInvoiceResponse'
                            x-xgen-preview:
                                name: invoicereporting
                            x-xgen-version: private-preview-invoicereporting
                    description: Associated invoices retrieved successfully
                "400":
                    $ref: '#/components/responses/badRequest'
                "401":
                    $ref: '#/components/responses/unauthorized'
                "403":
                    $ref: '#/components/responses/forbidden'
                "404":
                    $ref: '#/components/responses/notFound'
                "500":
                    $ref: '#/components/responses/internalServerError'
            summary: Return Associated Invoices
            tags:
                - Invoices
            x-beta: true
            x-codeSamples:
                - label: Atlas CLI
                  lang: cURL
                  source: atlas api invoices getOrgAssociatedInvoices --help
                - label: curl (Service Accounts)
                  lang: cURL
                  source: |-
                    curl --include --header "Authorization: Bearer ${ACCESS_TOKEN}" \
                      --header "Accept: application/vnd.atlas.preview+json" \
                      -X GET "https://cloud.mongodb.com/api/atlas/v2/orgs/{orgId}/associatedInvoices?pretty=true"
                - label: curl (Digest)
                  lang: cURL
                  source: |-
                    curl --user "${PUBLIC_KEY}:${PRIVATE_KEY}" \
                      --digest --include \
                      --header "Accept: application/vnd.atlas.preview+json" \
                      -X GET "https://cloud.mongodb.com/api/atlas/v2/orgs/{orgId}/associatedInvoices?pretty=true"
            x-state:
                color: '#B89D09'
                label: PREVIEW
            x-xgen-docs-url: https://mongodb.com/docs/atlas/reference/api-resources-spec/v2/#tag/Invoices/operation/getOrgAssociatedInvoices
    /api/atlas/v2/orgs/{orgId}/invoices/{invoiceId}:generateAndDownloadReport:
        post:
            description: |-
                This API is in preview. Breaking changes might be introduced before it is released. Don't use preview APIs in production.

                 Generates and downloads a report for the specified invoice.
            operationId: generateOrgInvoiceAndDownloadReport
            parameters:
                - $ref: '#/components/parameters/orgId'
                - description: Unique string that identifies the invoice for which to generate the report.
                  in: path
                  name: invoiceId
                  required: true
                  schema:
                    type: string
            requestBody:
                content:
                    application/vnd.atlas.preview+json:
                        schema:
                            $ref: '#/components/schemas/ReportGenerationRequest'
                        x-xgen-preview:
                            name: invoicereporting
                        x-xgen-version: private-preview-invoicereporting
                description: Generate and Download Invoice Report request body.
                required: true
            responses:
                "200":
                    content:
                        application/vnd.atlas.preview+gzip:
                            example: |
                                invoice_abc123_focus.csv.gz
                            schema:
                                type: string
                            x-xgen-preview:
                                name: invoicereporting
                            x-xgen-version: private-preview-invoicereporting
                    description: Report generated successfully
                "400":
                    $ref: '#/components/responses/badRequest'
                "401":
                    $ref: '#/components/responses/unauthorized'
                "403":
                    $ref: '#/components/responses/forbidden'
                "404":
                    $ref: '#/components/responses/notFound'
                "500":
                    $ref: '#/components/responses/internalServerError'
            summary: Generate and Download Invoice Report
            tags:
                - Invoices
            x-beta: true
            x-codeSamples:
                - label: Atlas CLI
                  lang: cURL
                  source: atlas api invoices generateInvoiceReport --help
                - label: curl (Service Accounts)
                  lang: cURL
                  source: |-
                    curl --include --header "Authorization: Bearer ${ACCESS_TOKEN}" \
                      --header "Accept: application/vnd.atlas.preview+gzip" \
                      --header "Content-Type: application/json" \
                      -X POST "https://cloud.mongodb.com/api/atlas/v2/orgs/{orgId}/invoices/{invoiceId}:generateAndDownloadReport" \
                      -d '{ <Payload> }'
                - label: curl (Digest)
                  lang: cURL
                  source: |-
                    curl --user "${PUBLIC_KEY}:${PRIVATE_KEY}" \
                      --digest --include \
                      --header "Accept: application/vnd.atlas.preview+gzip" \
                      --header "Content-Type: application/json" \
                      -X POST "https://cloud.mongodb.com/api/atlas/v2/orgs/{orgId}/invoices/{invoiceId}:generateAndDownloadReport" \
                      -d '{ <Payload> }'
            x-state:
                color: '#B89D09'
                label: PREVIEW
            x-xgen-docs-url: https://mongodb.com/docs/atlas/reference/api-resources-spec/v2/#tag/Invoices/operation/generateOrgInvoiceAndDownloadReport
            x-xgen-operation-id-override: generateInvoiceReport
security:
    - ServiceAccounts: []
    - DigestAuth: []
servers:
    - url: https://cloud.mongodb.com
tags:
    - description: Returns invoices.
      name: Invoices
x-externalLinks:
    - label: Back to Atlas Docs
      url: https://www.mongodb.com/docs/atlas/
    - label: API Changelog
      url: https://www.mongodb.com/docs/atlas/reference/api-resources-spec/changelog/

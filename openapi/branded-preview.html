<!DOCTYPE html>
<html lang="en">
    <head>
        <style>
            .url-container {
                margin: 16px 0;
            }

            .preview-span {
                margin-left: 8px;
            }
        </style>
    </head>
    <body>
        <h2>Preview docs for:</h2>
        <div class='url-container'><button onclick="generateLink(this, 'preview-url-1', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2023-01-01.json')">Generate preview link for openapi-2023-01-01.json</button><span class='preview-span' id='preview-url-1'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-2', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2023-01-01.yaml')">Generate preview link for openapi-2023-01-01.yaml</button><span class='preview-span' id='preview-url-2'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-3', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2023-02-01.json')">Generate preview link for openapi-2023-02-01.json</button><span class='preview-span' id='preview-url-3'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-4', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2023-02-01.yaml')">Generate preview link for openapi-2023-02-01.yaml</button><span class='preview-span' id='preview-url-4'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-5', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2023-10-01.json')">Generate preview link for openapi-2023-10-01.json</button><span class='preview-span' id='preview-url-5'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-6', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2023-10-01.yaml')">Generate preview link for openapi-2023-10-01.yaml</button><span class='preview-span' id='preview-url-6'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-7', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2023-11-15.json')">Generate preview link for openapi-2023-11-15.json</button><span class='preview-span' id='preview-url-7'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-8', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2023-11-15.yaml')">Generate preview link for openapi-2023-11-15.yaml</button><span class='preview-span' id='preview-url-8'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-9', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2024-05-30.json')">Generate preview link for openapi-2024-05-30.json</button><span class='preview-span' id='preview-url-9'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-10', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2024-05-30.yaml')">Generate preview link for openapi-2024-05-30.yaml</button><span class='preview-span' id='preview-url-10'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-11', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2024-08-05.json')">Generate preview link for openapi-2024-08-05.json</button><span class='preview-span' id='preview-url-11'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-12', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2024-08-05.yaml')">Generate preview link for openapi-2024-08-05.yaml</button><span class='preview-span' id='preview-url-12'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-13', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2024-10-23.json')">Generate preview link for openapi-2024-10-23.json</button><span class='preview-span' id='preview-url-13'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-14', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2024-10-23.yaml')">Generate preview link for openapi-2024-10-23.yaml</button><span class='preview-span' id='preview-url-14'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-15', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2024-11-13.json')">Generate preview link for openapi-2024-11-13.json</button><span class='preview-span' id='preview-url-15'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-16', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2024-11-13.yaml')">Generate preview link for openapi-2024-11-13.yaml</button><span class='preview-span' id='preview-url-16'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-17', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2025-02-19.json')">Generate preview link for openapi-2025-02-19.json</button><span class='preview-span' id='preview-url-17'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-18', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2025-02-19.yaml')">Generate preview link for openapi-2025-02-19.yaml</button><span class='preview-span' id='preview-url-18'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-19', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2025-03-12.json')">Generate preview link for openapi-2025-03-12.json</button><span class='preview-span' id='preview-url-19'></span></div><div class='url-container'><button onclick="generateLink(this, 'preview-url-20', 'https://raw.githubusercontent.com/mongodb/openapi/qa/openapi/v2/openapi-2025-03-12.yaml')">Generate preview link for openapi-2025-03-12.yaml</button><span class='preview-span' id='preview-url-20'></span></div>
        <script>
            async function generateLink(buttonEl, elId, url) {
                const previewSpan = document.getElementById(elId);
                if (!previewSpan) {
                    return;
                }

                buttonEl.disabled = true;
                previewSpan.innerHTML = 'Loading...';

                try {
                    const buildPreviewEndpoint = 'https://populate-data-extension.netlify.app/.netlify/functions/create-bump-preview';
                    const res = await fetch(buildPreviewEndpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ url }),
                    });

                    if (res.status === 201) {
                        const { public_url: previewUrl } = await res.json();
                        previewSpan.innerHTML = '';
                        const link = document.createElement('a');
                        link.href = previewUrl;
                        link.textContent = previewUrl;
                        link.target = '_blank';
                        previewSpan.appendChild(link);
                    }

                    if (res.status === 422) {
                        const resText = await res.text();
                        previewSpan.innerHTML = resText;
                    }
                } catch (err) {
                    console.error(err);
                    previewSpan.innerHTML = 'Error!';
                }
            }
        </script>
    </body>
</html>
